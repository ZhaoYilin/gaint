<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. Hamiltonian Integral &mdash; gaint 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/moha.ico"/>
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Mcmurchie Davidson Scheme" href="mcmurchie_davidson.html" />
    <link rel="prev" title="4. Basis Set" href="basis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html">
            <img src="../_static/moha.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">USER DOCUMENTATION:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="molecule.html">3. Molecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="basis.html">4. Basis Set</a></li>
<li class="toctree-l1"><a class="reference internal" href="basis.html#Primitive-Gaussian-Type-Orbital">5. Primitive Gaussian Type Orbital</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Hamiltonian Integral</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Primitive-Gaussian-Type-Orbital">6.1. Primitive Gaussian Type Orbital</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Boys-Function">6.2. Boys Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Overlap">6.3. Overlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Kinetic">6.4. Kinetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Nuclear-Attraction">6.5. Nuclear Attraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Electron-Repulsion">6.6. Electron Repulsion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mcmurchie_davidson.html">7. Mcmurchie Davidson Scheme</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gaint</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">6. </span>Hamiltonian Integral</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/obara_saika.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Hamiltonian-Integral">
<h1><span class="section-number">6. </span>Hamiltonian Integral<a class="headerlink" href="#Hamiltonian-Integral" title="Permalink to this headline"></a></h1>
<p>The one- and two-electron integrals involved in the chemical electronic Hamiltonian are considered in this subsection.</p>
<p><span class="math">\begin{equation}
\hat{H}= -\sum^N_{i=1}\frac{\hbar^2}{2m_i}{\nabla}_i^2
-\sum^N_{i=1}\sum^M_{\alpha=1} \frac{Z_a e^2}{\textbf{r}_{ia}}
+\sum^N_{i=1}\sum^N_{j>i} \frac{e^2}{\textbf{r}_{ij}}
\tag{1}
\label{ham}
\end{equation}</span></p>
<p>There are many integration schemes including McMurchie–Davidson, Obara–Saika and Rys schemes. Here only Obara-Saika scheme is shown in this note.</p>
<section id="Primitive-Gaussian-Type-Orbital">
<h2><span class="section-number">6.1. </span>Primitive Gaussian Type Orbital<a class="headerlink" href="#Primitive-Gaussian-Type-Orbital" title="Permalink to this headline"></a></h2>
<p>Most quantum chemistry package supports Contracted Gaussian type orbtial(CGTO), it is an atomic orbital forming in linear combinations of primitive Gaussians type orbital(PGTO). Here in this note, only the integral over primitive Gaussian type orbital is to be considered which are defiend by an angular part which is homogeneous polynomial in the compoents x, y, and z of the position vector <span class="math notranslate nohighlight">\(\mathbf{r}\)</span>. That is,</p>
<p><span class="math">\begin{equation}
G_{ijk}(r_A,a) = x^i_A y^j_A z^k_A e^{-a r^2_A}
\end{equation}</span></p>
<ul class="simple">
<li><p>a&gt;0 is the orbital exponent.</p></li>
<li><p><span class="math notranslate nohighlight">\(r_A = r − A\)</span> is the electronic coordinate.</p></li>
<li><p>i ≥ 0, j ≥ 0, k ≥ 0 is the quantum number.</p></li>
<li><p>Total angular-momentum quantum number l = i + j + k ≥ 0</p></li>
</ul>
<p>The Cartesian Gaussians may be factorized in the three Cartesian directons <span class="math">\begin{equation}
G_{ijk}(r_A,a) = G_i(r_A,a)G_j(r_A,a)G_k(r_A,a)
\end{equation}</span> where <span class="math">\begin{equation}
G_i(r_A,a)= x^i_A e^{-a x^2_A}
\end{equation}</span></p>
<p>Gaussians satisfy a simple recurrence relation:</p>
<p><span class="math">\begin{equation}
x_A G_i(a, x_A ) = G_{i+1}(a, x_A )
\end{equation}</span></p>
<p>The differentiation of a Gaussian yields a linear combination of two Gaussians <span class="math">\begin{equation}
\frac{\partial G_i(a, x_A )}{\partial A_x}
= -\frac{\partial G_i(a, x_A)}{\partial x}
= 2aG_{i+1}(a, x_A) − iG_{i−1}(a, x_A)
\end{equation}</span></p>
<p>An important property of Gaussians is the Gaussian product rule. The product of two Gaussians is another Gaussian centered somewhere on the line connecting the original Gaussians; its exponent is the sum of the original exponents:</p>
<p><span class="math">\begin{equation}
e^{-a x^2_A} e^{-b x^2_B} = e^{-\mu X_{AB}^2}  e^{-p x^2_P}
\end{equation}</span></p>
<p>while the centre-of-charge <span class="math notranslate nohighlight">\(P_x\)</span> and the relative coordinate or Gaussian separation <span class="math notranslate nohighlight">\(X_{AB}\)</span> are given by</p>
<p><span class="math">\begin{equation}
\begin{aligned}
p &= a+b\\
\mu &= \frac{ab}{a+b}\\
P_x &= \frac{aA_x+bB_x}{a+b}\\
X_{AB} &= A_x - B_x
\end{aligned}
\end{equation}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">PrimitiveGaussian</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Primitive Gaussian functions.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    origin : 3-list</span>
<span class="sd">        Coordinate of the nuclei.</span>

<span class="sd">    n : int</span>
<span class="sd">        Principal quantum number.</span>

<span class="sd">    shell : 3-tuple</span>
<span class="sd">        Angular momentum.</span>

<span class="sd">    coef : float</span>
<span class="sd">        Coefficent of Primitive Gaussian function.</span>

<span class="sd">    exp : float</span>
<span class="sd">        Primitive Gaussian exponent.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    __init__(self,type,origin,n,shell,coef,exp)</span>
<span class="sd">        Initialize the instance.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">coefficient</span><span class="p">,</span><span class="n">origin</span><span class="p">,</span><span class="n">shell</span><span class="p">,</span><span class="n">exponent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        origin : list</span>
<span class="sd">            Coordinate of the nuclei.</span>

<span class="sd">        n : int</span>
<span class="sd">            Principal quantum number.</span>

<span class="sd">        shell : list</span>
<span class="sd">            Angular momentum.</span>

<span class="sd">        coef : float</span>
<span class="sd">            Primitive Gaussian coefficients.</span>

<span class="sd">        exp : float</span>
<span class="sd">            Primitive Gaussian exponent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coefficient</span> <span class="o">=</span> <span class="n">coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">origin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shell</span> <span class="o">=</span> <span class="n">shell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exponent</span>  <span class="o">=</span> <span class="n">exponent</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Molecular coordinates</span>
    <span class="n">H2O</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.43233673</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.96104039</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.43233673</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.96104039</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.24026010</span><span class="p">]]</span>

    <span class="c1"># Orbital exponents</span>
    <span class="n">OrbCoeff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.425250914</span><span class="p">,</span> <span class="mf">0.6239137298</span><span class="p">,</span> <span class="mf">0.168855404</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">3.425250914</span><span class="p">,</span> <span class="mf">0.6239137298</span><span class="p">,</span> <span class="mf">0.168855404</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">130.7093214</span><span class="p">,</span> <span class="mf">23.80886605</span><span class="p">,</span> <span class="mf">6.443608313</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">5.033151319</span><span class="p">,</span> <span class="mf">1.169596125</span><span class="p">,</span> <span class="mf">0.38038896</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">5.033151319</span><span class="p">,</span> <span class="mf">1.169596125</span><span class="p">,</span> <span class="mf">0.38038896</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">5.033151319</span><span class="p">,</span> <span class="mf">1.169596125</span><span class="p">,</span> <span class="mf">0.38038896</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">5.033151319</span><span class="p">,</span> <span class="mf">1.169596125</span><span class="p">,</span> <span class="mf">0.38038896</span><span class="p">]])</span>

    <span class="c1"># H1s, H2s, O1s, O2s, O2px , O2py, O2p</span>
    <span class="n">FCenter</span> <span class="o">=</span> <span class="p">[</span><span class="n">H2O</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">H2O</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">H2O</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">H2O</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">H2O</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">H2O</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">H2O</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="n">CartAng</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

    <span class="n">pga</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">FCenter</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">CartAng</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">OrbCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">pgb</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">FCenter</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">CartAng</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span><span class="n">OrbCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</section>
<section id="Boys-Function">
<h2><span class="section-number">6.2. </span>Boys Function<a class="headerlink" href="#Boys-Function" title="Permalink to this headline"></a></h2>
<p>The boys function of order n is defined by</p>
<p><span class="math">\begin{equation}
F_n(x) = \int_0^1 exp(-xt^2)t^{2n}dt\tag{1}
\label{boys}
\end{equation}</span></p>
<p>for <span class="math notranslate nohighlight">\(x\geq 0\)</span>, It is a strictly positive function since the integrand is positive</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.special</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">sqrt</span>

<span class="k">def</span> <span class="nf">boys</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Boys function for the calculation of coulombic integrals.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n : int</span>
<span class="sd">        Order of boys function</span>

<span class="sd">    t : float</span>
<span class="sd">        Varible for boys function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">hyp1f1</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mf">1.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">boys_recursion</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">f_N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the answer to the boys function f_{v - 1}(x) using the</span>
<span class="sd">    answer for the boys function f_{v}(x).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    v : {int, float}</span>
<span class="sd">    x : {int, float}</span>
<span class="sd">    f_v : float</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : float</span>
<span class="sd">        The boys function f_{N - 1}(x).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span>  <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">f_N</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</section>
<section id="Overlap">
<h2><span class="section-number">6.3. </span>Overlap<a class="headerlink" href="#Overlap" title="Permalink to this headline"></a></h2>
<p>Let us frist consider the simple overlap integral <span class="math">\begin{equation}
S_{ab} = \langle G_a|G_b \rangle
\end{equation}</span></p>
<p>it can be factorized in the three Cartesian directons <span class="math">\begin{equation}
S_{ab} = S_{ij}S_{kl}S_{mn}
\end{equation}</span></p>
<p>The Obara-Saika recurrence relations for the Cartesian overlap integral over one direction is:</p>
<p><span class="math">\begin{equation}
\begin{aligned}
S_{i+1,j} &= X_{PA}S_{ij} + \frac{1}{2p}(iS_{i-1,j}+jS_{i,j-1})\\
S_{i,j+1} &= X_{PB}S_{ij} + \frac{1}{2p}(iS_{i-1,j}+jS_{i,j-1})\\
\end{aligned}
\end{equation}</span></p>
<p>With the boundary condtion</p>
<p><span class="math">\begin{equation}
S_{0,0} = \sqrt(\frac{\pi}{p}) exp(-\mu X_{AB}^2)
\end{equation}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Overlap</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Obara-Saika scheme for three-dimensional overlap integral over</span>
<span class="sd">    primitive Gaussian orbitals.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : float</span>
<span class="sd">        Gaussian exponent facotr.</span>

<span class="sd">    b : float</span>
<span class="sd">        Gaussian exponent facotr.</span>

<span class="sd">    i : int</span>
<span class="sd">        Angular momentum quantum number.</span>

<span class="sd">    j : int</span>
<span class="sd">        Angular momentum quantum number.</span>

<span class="sd">    A : float</span>
<span class="sd">        Coordinate in on direction.</span>

<span class="sd">    B : float</span>
<span class="sd">        Coordinate in on direction.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : float</span>
<span class="sd">        The non-normalizecd overlap interal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates non-normalizecd overlap integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pga: PrimitiveGaussian</span>
<span class="sd">            The first primitive gaussian orbital.</span>

<span class="sd">        pgb: PrimitiveGaussian</span>
<span class="sd">            The second primitive gaussian orbital.</span>

<span class="sd">        C: List[float,float,float]</span>
<span class="sd">            Coordinate of nuclei.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">S1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">XAB</span> <span class="o">=</span> <span class="n">A</span><span class="o">-</span><span class="n">B</span>

        <span class="k">if</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Starting from the spherical Gaussians.</span>
            <span class="n">S00</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">XAB</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">S00</span>

    <span class="k">def</span> <span class="nf">recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">):</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">term2</span> <span class="o">=</span> <span class="n">term3</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="n">p</span>
        <span class="n">XPA</span> <span class="o">=</span> <span class="n">P</span><span class="o">-</span><span class="n">A</span>

        <span class="k">if</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term3</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span> <span class="o">+</span> <span class="n">term3</span>

    <span class="k">def</span> <span class="nf">gaussian_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="n">ca</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">coefficient</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">coefficient</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">origin</span>

        <span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span>

        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pga_i_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_i_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_j_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_i_1</span><span class="p">,</span> <span class="n">pga_i_2</span><span class="p">,</span> <span class="n">pgb_j_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pga_k_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_k_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_l_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_k_1</span><span class="p">,</span> <span class="n">pga_k_2</span><span class="p">,</span> <span class="n">pgb_l_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pga_m_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_m_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_n_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_m_1</span><span class="p">,</span> <span class="n">pga_m_2</span><span class="p">,</span> <span class="n">pgb_n_1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The overlap integral between two primitive Gaussian type orbital</span>
<span class="n">S_integral</span> <span class="o">=</span> <span class="n">Overlap</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S_integral</span><span class="p">(</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-8.880194157791243e-05
</pre></div></div>
</div>
</section>
<section id="Kinetic">
<h2><span class="section-number">6.4. </span>Kinetic<a class="headerlink" href="#Kinetic" title="Permalink to this headline"></a></h2>
<p>Consider the integral of electrons kinetic energy</p>
<p><span class="math">\begin{equation}
\begin{aligned}
T_{a,b} &= \langle G_a  \vert -\sum^N_{i=1}\frac{\hbar^2}{2m_i}\boldsymbol{\nabla}_i^2 \vert G_b \rangle\\
T_{a,b} &= T_{ij}S_{kl}S_{mn} + S_{ij}T_{kl}S_{mn} + S_{ij}S_{kl}T_{mn}
\end{aligned}
\end{equation}</span></p>
<p>The Obara-Saika recurrence relations for the Cartesian kinetic integrals over one direction is:</p>
<p><span class="math">\begin{equation}
\begin{aligned}
T_{i+1,j} &= X_{PA}T_{ij} + \frac{1}{2p}(iT_{i-1,j}+jT_{i,j-1}) + \frac{b}{p}(2aS_{i+1,j}-iS_{i-1,j})\\
T_{i,j+1} &= X_{PB}T_{ij} + \frac{1}{2p}(iT_{i-1,j}+jT_{i,j-1})+ \frac{a}{p}(2bS_{i,j+1}-jS_{i,j-1})\\
\end{aligned}
\end{equation}</span></p>
<p>With the boundary condtion</p>
<p><span class="math">\begin{equation}
T_{0,0} = \left[a-2a^2(X_{PA}^2 + \frac{1}{2p})\right] S_{00}
\end{equation}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overlap</span> <span class="o">=</span> <span class="n">Overlap</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">Kinetic</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Obara-Saika scheme for three-dimensional kinetic energy integral over</span>
<span class="sd">    primitive Gaussian orbitals.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : float</span>
<span class="sd">        Gaussian exponent facotr.</span>

<span class="sd">    b : float</span>
<span class="sd">        Gaussian exponent facotr.</span>

<span class="sd">    i : int</span>
<span class="sd">        Angular momentum quantum number.</span>

<span class="sd">    j : int</span>
<span class="sd">        Angular momentum quantum number.</span>

<span class="sd">    A : float</span>
<span class="sd">        Coordinate in on direction.</span>

<span class="sd">    B : float</span>
<span class="sd">        Coordinate in on direction.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    result : float</span>
<span class="sd">        The non-normalizecd kinetic interals in one dimension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pga: PrimitiveGaussian</span>
<span class="sd">            The first primitive gaussian orbital.</span>

<span class="sd">        pgb: PrimitiveGaussian</span>
<span class="sd">            The second primitive gaussian orbital.</span>

<span class="sd">        C: List[float,float,float]</span>
<span class="sd">            Coordinate of nuclei.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Sij</span> <span class="o">=</span> <span class="n">overlap</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">)</span>
        <span class="n">Skl</span> <span class="o">=</span> <span class="n">overlap</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">)</span>
        <span class="n">Smn</span> <span class="o">=</span> <span class="n">overlap</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">)</span>

        <span class="n">Tij</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">)</span>
        <span class="n">Tkl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">)</span>
        <span class="n">Tmn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">)</span>

        <span class="n">Tab</span> <span class="o">=</span> <span class="n">Tij</span><span class="o">*</span><span class="n">Skl</span><span class="o">*</span><span class="n">Smn</span><span class="o">+</span><span class="n">Sij</span><span class="o">*</span><span class="n">Tkl</span><span class="o">*</span><span class="n">Smn</span><span class="o">+</span><span class="n">Sij</span><span class="o">*</span><span class="n">Skl</span><span class="o">*</span><span class="n">Tmn</span>
        <span class="k">return</span> <span class="n">Tab</span>

    <span class="k">def</span> <span class="nf">T1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="n">p</span>
        <span class="n">XAB</span> <span class="o">=</span> <span class="n">A</span><span class="o">-</span><span class="n">B</span>
        <span class="n">XPA</span> <span class="o">=</span> <span class="n">P</span><span class="o">-</span><span class="n">A</span>

        <span class="k">if</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Starting from the spherical Gaussians.</span>
            <span class="n">S00</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">p</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">XAB</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">T00</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="p">)))</span><span class="o">*</span><span class="n">S00</span>
            <span class="k">return</span> <span class="n">T00</span>

    <span class="k">def</span> <span class="nf">recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">):</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">term2</span> <span class="o">=</span> <span class="n">term3</span> <span class="o">=</span> <span class="n">term4</span> <span class="o">=</span> <span class="n">term5</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="n">p</span>
        <span class="n">XPA</span> <span class="o">=</span> <span class="n">P</span><span class="o">-</span><span class="n">A</span>

        <span class="k">if</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term3</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">)</span>
        <span class="n">term4</span> <span class="o">=</span>  <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">p</span> <span class="o">*</span> <span class="n">overlap</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term5</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="n">overlap</span><span class="o">.</span><span class="n">S1d</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span> <span class="o">+</span> <span class="n">term3</span> <span class="o">+</span> <span class="n">term4</span> <span class="o">-</span> <span class="n">term5</span>

    <span class="k">def</span> <span class="nf">gaussian_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="n">ca</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">coefficient</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">coefficient</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">origin</span>

        <span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span>

        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pga_i_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_i_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_j_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_i_1</span><span class="p">,</span> <span class="n">pga_i_2</span><span class="p">,</span> <span class="n">pgb_j_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pga_k_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_k_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_l_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_k_1</span><span class="p">,</span> <span class="n">pga_k_2</span><span class="p">,</span> <span class="n">pgb_l_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pga_m_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_m_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_n_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_m_1</span><span class="p">,</span> <span class="n">pga_m_2</span><span class="p">,</span> <span class="n">pgb_n_1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The kinetic integral between two primitive Gaussian type orbital</span>
<span class="n">T_integral</span> <span class="o">=</span> <span class="n">Kinetic</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">T_integral</span><span class="p">(</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.0016734344532709933
</pre></div></div>
</div>
</section>
<section id="Nuclear-Attraction">
<h2><span class="section-number">6.5. </span>Nuclear Attraction<a class="headerlink" href="#Nuclear-Attraction" title="Permalink to this headline"></a></h2>
<p><span class="math">\begin{equation}
\begin{aligned}
V_{a,b} &=\langle G_a \vert -\sum^N_{i=1}\sum^M_{\alpha=1} \frac{Z_\alpha e^2}{\textbf{r}_{i\alpha}} \vert G_b \rangle \\
V_{a,b} &= V_{ijklmn}^{000} = \Theta_{ijklmn}^{0}
\end{aligned}
\end{equation}</span></p>
<p>The Obara-Saika recurrence relations for the Cartesian nuclear attraction integrals:</p>
<p><span class="math">\begin{equation}
\begin{aligned}
\Theta_{i+1,j,k,l,m,n}^{N} &= X_{PA}\Theta_{ijkln}^{N}
+\frac{1}{2p}(i\Theta_{i-1,j,k,l,m,n}^{N} + j\Theta_{i,j-1,k,l,m,n}^{N})\\
&-X_{PC}\Theta_{ijklmn}^{N+1}
-\frac{1}{2p}(i\Theta_{i-1,j,k,l,m,n}^{N+1} + j\Theta_{i,j-1,k,l,m,n}^{N+1})\\
\Theta_{i,j+1,k,l,m,n}^{N} &= X_{PB}\Theta_{ijkln}^{N}
+\frac{1}{2p}(i\Theta_{i-1,j,k,l,m,n}^{N} + j\Theta_{i,j-1,k,l,m,n}^{N})\\
&-X_{PC}\Theta_{ijklmn}^{N+1}
-\frac{1}{2p}(i\Theta_{i-1,j,k,l,m,n}^{N+1} + j\Theta_{i,j-1,k,l,m,n}^{N+1})\\
\end{aligned}
\end{equation}</span></p>
<p>With the boundary condtion</p>
<p><span class="math">\begin{equation}
\Theta_{000000}^{N} = \frac{2\pi}{p}(-2p)^{-N}K_{ab}^{xyz}R_{000}^{N}
= \frac{2\pi}{p} K_{ab}^{xyz}F_N(pR_{PC}^2)
\end{equation}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NuclearAttraction</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The Obara-Saika scheme for three-dimensional nuclear attraction integral over</span>
<span class="sd">    primitive Gaussian orbitals.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p : float</span>
<span class="sd">        The total exponent.</span>

<span class="sd">    mu : float</span>
<span class="sd">        The reduced exponent.</span>

<span class="sd">    P : List[float,float,float]</span>
<span class="sd">        The centre of charge coordinate.</span>

<span class="sd">    C : List[float,float,float]</span>
<span class="sd">        The coordinate of given nuclei.</span>

<span class="sd">    Kab : float</span>
<span class="sd">        The pre-exponential factor.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    __init__(self)</span>
<span class="sd">        Initialize the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Kab</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">C</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pga: PrimitiveGaussian</span>
<span class="sd">            The first primitive gaussian orbital.</span>

<span class="sd">        pgb: PrimitiveGaussian</span>
<span class="sd">            The second primitive gaussian orbital.</span>

<span class="sd">        C: List[float,float,float]</span>
<span class="sd">            Coordinate of nuclei.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l_total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="n">p</span>

        <span class="n">RAB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">)</span>
        <span class="n">RPA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">A</span><span class="p">)</span>
        <span class="n">RPB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">B</span><span class="p">)</span>
        <span class="n">RPC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">C</span><span class="p">)</span>

        <span class="n">Kab</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">RAB</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">P</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Kab</span> <span class="o">=</span> <span class="n">Kab</span>

        <span class="c1"># Build boys function F_{N}(x)</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">l_total</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">RPC</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">boys_pre_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="n">p</span><span class="o">*</span><span class="n">Kab</span>
        <span class="n">boys_function</span> <span class="o">=</span> <span class="n">boys</span><span class="p">(</span><span class="n">l_total</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">Theta_N_000000</span> <span class="o">=</span> <span class="n">boys_pre_factor</span> <span class="o">*</span> <span class="n">boys_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">l_total</span><span class="p">:</span> <span class="n">Theta_N_000000</span><span class="p">}</span>

        <span class="k">while</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">boys_function</span> <span class="o">=</span> <span class="n">boys_recursion</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">boys_function</span><span class="p">)</span>
            <span class="n">N</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">Theta_N_000000</span> <span class="o">=</span> <span class="n">boys_pre_factor</span> <span class="o">*</span> <span class="n">boys_function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">Theta_N_000000</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">V</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        N : int</span>
<span class="sd">            Order of the boys function F_{N}(x).</span>

<span class="sd">        pga : PrimitiveGaussian</span>
<span class="sd">            The first primitive gaussian orbital.</span>

<span class="sd">        pgb : PrimitiveGaussian</span>
<span class="sd">            The second primitive gaussian orbital.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        vlaue : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span><span class="p">[</span><span class="n">N</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r : int</span>
<span class="sd">            Cartesian index 0, 1, 2.</span>

<span class="sd">        N : int</span>
<span class="sd">            Order of the boys function F_{N}(x).</span>

<span class="sd">        pga_1 : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pga_2 : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb_1 : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">term2</span> <span class="o">=</span> <span class="n">term3</span> <span class="o">=</span> <span class="n">term4</span> <span class="o">=</span> <span class="n">term5</span> <span class="o">=</span> <span class="n">term6</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="n">p</span>
        <span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span>

        <span class="n">XPA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
        <span class="n">XPC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">A</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term3</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">C</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">term4</span> <span class="o">=</span> <span class="n">XPC</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term5</span> <span class="o">=</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term6</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">term1</span><span class="o">+</span><span class="n">term2</span><span class="o">+</span><span class="n">term3</span><span class="o">-</span><span class="n">term4</span><span class="o">-</span><span class="n">term5</span><span class="o">-</span><span class="n">term6</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">gaussian_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r : int</span>
<span class="sd">            Cartesian index 0, 1, 2.</span>

<span class="sd">        N : int</span>
<span class="sd">            Order of the boys function F_{N}(x).</span>

<span class="sd">        pga : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : Tuple(pg,pg,pg,pg)</span>
<span class="sd">            Tuple of 4 PrimitiveGaussian orbital instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ca</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">coefficient</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">coefficient</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">origin</span>

        <span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">m</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span>

        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pga_i_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_i_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_j_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_i_1</span><span class="p">,</span> <span class="n">pga_i_2</span><span class="p">,</span> <span class="n">pgb_j_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pga_k_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_k_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_l_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_k_1</span><span class="p">,</span> <span class="n">pga_k_2</span><span class="p">,</span> <span class="n">pgb_l_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pga_m_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_m_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_n_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga_m_1</span><span class="p">,</span> <span class="n">pga_m_2</span><span class="p">,</span> <span class="n">pgb_n_1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The nuclear attraction integral between two primitive Gaussian type orbital</span>
<span class="n">V_integral</span> <span class="o">=</span> <span class="n">NuclearAttraction</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V_integral</span><span class="p">(</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">,</span><span class="n">FCenter</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-8.543259485351415e-05
</pre></div></div>
</div>
</section>
<section id="Electron-Repulsion">
<h2><span class="section-number">6.6. </span>Electron Repulsion<a class="headerlink" href="#Electron-Repulsion" title="Permalink to this headline"></a></h2>
<p><span class="math">\begin{equation}
V_{abcd} = \langle G_a G_b\vert \sum^N_{i=1}\sum^N_{j>i} \frac{e^2}{\textbf{r}_{ij}}\vert G_c G_d \rangle
\end{equation}</span></p>
<p>The source and target integrals: <span class="math">\begin{equation}
\begin{aligned}
\Theta_{0000;0000;0000}^{N} &= \frac{2\pi^{2.5}}{pq\sqrt{p+q}}
K_{ab}^{xyz}K_{cd}^{xyz}F_N(\alpha R_{PQ}^2)\\
\Theta_{i_xj_xk_xl_x;i_yj_yk_yl_y;i_zj_zk_zl_z}^{0} &= g_{i_xj_xk_xl_x;i_yj_yk_yl_y;i_zj_zk_zl_z}
\end{aligned}
\end{equation}</span></p>
<p>The Obara-Saika two electron recurrence relation <span class="math">\begin{equation}
\begin{aligned}
\Theta_{i+1,j,k,l}^{N} &=
X_{PA}\Theta_{ijkl}^{N}
-\frac{\alpha}{p}X_{PQ}\Theta_{i,j,k,l}^{N+1}
+\frac{i}{2p}\left(\Theta_{i-1,j,k,l}^{N}-\frac{\alpha}{p}\Theta_{i-1,j,k,l}^{N+1}\right)\\
&+\frac{j}{2p}\left(\Theta_{i,j-1,k,l}^{N}-\frac{\alpha}{p}\Theta_{i,j-1,k,l}^{N+1}\right)
-\frac{k}{2(p+q)}\Theta_{i,j,k-1,l}^{N+1}
-\frac{l}{2(p+q)}\Theta_{i,j,k,l-1}^{N+1}
\end{aligned}
\end{equation}</span> Using the horizontal recurrence relation, a similar relation may be written down for increments in j, replaceing <span class="math notranslate nohighlight">\(X_{PA}\)</span> with <span class="math notranslate nohighlight">\(X_{PB}\)</span>.</p>
<p><span class="math">\begin{equation}
\begin{aligned}
\Theta_{i,j,k+1,l}^{N} &=
X_{QC}\Theta_{ijkl}^{N}
-\frac{\alpha}{q}X_{PQ}\Theta_{i,j,k,l}^{N+1}
+\frac{k}{2q}\left(\Theta_{i,j,k-1,l}^{N}-\frac{\alpha}{q}\Theta_{i,j,k-1,l}^{N+1}\right)\\
&+\frac{l}{2q}\left(\Theta_{i,j,k,l-1}^{N}-\frac{\alpha}{q}\Theta_{i,j,k,l-1}^{N+1}\right)
-\frac{i}{2(p+q)}\Theta_{i-1,j,k,l}^{N+1}
-\frac{j}{2(p+q)}\Theta_{i,j-1,k,l}^{N+1}
\end{aligned}
\end{equation}</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ElectronRepulsion</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;The Obara-Saika scheme for three-dimensional nuclear attraction integral over</span>
<span class="sd">    primitive Gaussian orbitals.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    p : float</span>
<span class="sd">        The total exponent.</span>

<span class="sd">    mu : float</span>
<span class="sd">        The reduced exponent.</span>

<span class="sd">    P : List[float,float,float]</span>
<span class="sd">        The centre of charge coordinate.</span>

<span class="sd">    C : List[float,float,float]</span>
<span class="sd">        The coordinate of given nuclei.</span>

<span class="sd">    Kab : float</span>
<span class="sd">        The pre-exponential factor.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    __init__(self)</span>
<span class="sd">        Initialize the instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pga: PrimitiveGaussian</span>
<span class="sd">            The first primitive gaussian orbital.</span>

<span class="sd">        pgb: PrimitiveGaussian</span>
<span class="sd">            The second primitive gaussian orbital.</span>

<span class="sd">        C: List[float,float,float]</span>
<span class="sd">            Coordinate of nuclei.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">l_total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pgc</span><span class="o">.</span><span class="n">shell</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pgd</span><span class="o">.</span><span class="n">shell</span><span class="p">)</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgc</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgd</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">C</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">D</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
        <span class="n">R</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">P</span><span class="o">+</span><span class="n">q</span><span class="o">*</span><span class="n">Q</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">q</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">R</span>

        <span class="n">RAB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">)</span>
        <span class="n">RCD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">D</span><span class="p">)</span>
        <span class="n">RPQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">P</span><span class="o">-</span><span class="n">Q</span><span class="p">)</span>

        <span class="c1"># Build boys function F_{N}(x)</span>
        <span class="n">Kab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">mu</span><span class="o">*</span><span class="n">RAB</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">Kcd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">nu</span><span class="o">*</span><span class="n">RCD</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">boys_pre_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">q</span><span class="p">))</span><span class="o">*</span><span class="n">Kab</span><span class="o">*</span><span class="n">Kcd</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">l_total</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">RPQ</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">boys_function</span> <span class="o">=</span> <span class="n">boys</span><span class="p">(</span><span class="n">l_total</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">Theta_N_0000_0000_0000</span> <span class="o">=</span> <span class="n">boys_pre_factor</span> <span class="o">*</span> <span class="n">boys_function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">l_total</span><span class="p">:</span> <span class="n">Theta_N_0000_0000_0000</span><span class="p">}</span>

        <span class="k">while</span> <span class="n">N</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">boys_function</span> <span class="o">=</span> <span class="n">boys_recursion</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">boys_function</span><span class="p">)</span>
            <span class="n">N</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">Theta_N_0000_0000_0000</span> <span class="o">=</span> <span class="n">boys_pre_factor</span> <span class="o">*</span> <span class="n">boys_function</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">Theta_N_0000_0000_0000</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">Eri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        N : int</span>
<span class="sd">            Order of the boys function F_{N}(x).</span>

<span class="sd">        pga : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgc : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgd : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        vlaue : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pgc</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pgc</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pgc</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgc</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgc</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgc</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgd</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgd</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pgd</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">gaussian_factory</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pga</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">boys_dict</span><span class="p">[</span><span class="n">N</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">recursive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">,</span> <span class="n">pgc_1</span><span class="p">,</span> <span class="n">pgd_1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r : int</span>
<span class="sd">            Cartesian index 0, 1, 2.</span>

<span class="sd">        N : int</span>
<span class="sd">            Order of the boys function F_{N}(x).</span>

<span class="sd">        pga_1 : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pga_2 : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb_1 : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : float</span>
<span class="sd">            Integral value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="n">term2</span> <span class="o">=</span> <span class="n">term3</span> <span class="o">=</span> <span class="n">term4</span> <span class="o">=</span> <span class="n">term5</span> <span class="o">=</span> <span class="n">term6</span> <span class="o">=</span> <span class="n">term7</span> <span class="o">=</span> <span class="n">term8</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">q</span><span class="p">)</span>
        <span class="c1">#alpha = self.alpha</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pga</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgb</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgc</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pgd</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">A</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">B</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">C</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">D</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>

        <span class="n">XPA</span> <span class="o">=</span> <span class="n">P</span> <span class="o">-</span> <span class="n">A</span>
        <span class="n">XPQ</span> <span class="o">=</span> <span class="n">P</span> <span class="o">-</span> <span class="n">Q</span>

        <span class="k">if</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term1</span> <span class="o">=</span> <span class="n">XPA</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">XPQ</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term2</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="n">p</span><span class="o">*</span><span class="n">XPQ</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term3</span> <span class="o">=</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
            <span class="n">term4</span> <span class="o">=</span> <span class="n">pga_1</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term5</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
            <span class="n">term6</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">p</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgc</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term7</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc_1</span><span class="p">,</span> <span class="n">pgd</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pgd</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">term8</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">shell</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eri</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd_1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span> <span class="o">+</span> <span class="n">term3</span> <span class="o">-</span> <span class="n">term4</span> <span class="o">+</span> <span class="n">term5</span> <span class="o">-</span> <span class="n">term6</span> <span class="o">+</span> <span class="n">term7</span> <span class="o">+</span> <span class="n">term8</span>

    <span class="k">def</span> <span class="nf">gaussian_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates nuclear attraction integral over two primitive gaussian orbitals.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r : int</span>
<span class="sd">            Cartesian index 0, 1, 2.</span>

<span class="sd">        N : int</span>
<span class="sd">            Order of the boys function F_{N}(x).</span>

<span class="sd">        pga : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        pgb : PrimitiveGaussian</span>
<span class="sd">            The primitive gaussian orbital.</span>

<span class="sd">        Return</span>
<span class="sd">        ------</span>
<span class="sd">        result : Tuple(pg,pg,pg,pg)</span>
<span class="sd">            Tuple of 4 PrimitiveGaussian orbital instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ca</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">coefficient</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">coefficient</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">coefficient</span>
        <span class="n">cd</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">coefficient</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">exponent</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">exponent</span>

        <span class="n">A</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">B</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">origin</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">origin</span>

        <span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">,</span><span class="n">iz</span> <span class="o">=</span> <span class="n">pga</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">jx</span><span class="p">,</span><span class="n">jy</span><span class="p">,</span><span class="n">jz</span> <span class="o">=</span> <span class="n">pgb</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="n">pgc</span><span class="o">.</span><span class="n">shell</span>
        <span class="n">lx</span><span class="p">,</span><span class="n">ly</span><span class="p">,</span><span class="n">lz</span> <span class="o">=</span> <span class="n">pgd</span><span class="o">.</span><span class="n">shell</span>

        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pga_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">ix</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">ix</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">jx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">pgc_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="p">(</span><span class="n">kx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">kz</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">pgd_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cd</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">lx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ly</span><span class="p">,</span> <span class="n">lz</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">,</span> <span class="n">pgc_1</span><span class="p">,</span> <span class="n">pgd_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pga_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iz</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">iz</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">jz</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">pgc_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="p">(</span><span class="n">kx</span><span class="p">,</span> <span class="n">ky</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kz</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">pgd_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cd</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lz</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">,</span> <span class="n">pgc_1</span><span class="p">,</span> <span class="n">pgd_1</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">pga_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pga_2</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">ca</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">a</span><span class="p">)</span>
            <span class="n">pgb_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="p">(</span><span class="n">jx</span><span class="p">,</span> <span class="n">jy</span><span class="p">,</span> <span class="n">jz</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">pgc_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="p">(</span><span class="n">kx</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">kz</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">c</span><span class="p">)</span>
            <span class="n">pgd_1</span> <span class="o">=</span> <span class="n">PrimitiveGaussian</span><span class="p">(</span><span class="n">cd</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">,</span> <span class="n">lz</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pga</span><span class="p">,</span> <span class="n">pgb</span><span class="p">,</span> <span class="n">pgc</span><span class="p">,</span> <span class="n">pgd</span><span class="p">,</span> <span class="n">pga_1</span><span class="p">,</span> <span class="n">pga_2</span><span class="p">,</span> <span class="n">pgb_1</span><span class="p">,</span> <span class="n">pgc_1</span><span class="p">,</span> <span class="n">pgd_1</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The overlap integral between two primitive Gaussian type orbital</span>
<span class="n">Eri_integral</span> <span class="o">=</span> <span class="n">ElectronRepulsion</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Eri_integral</span><span class="p">(</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">,</span><span class="n">pga</span><span class="p">,</span><span class="n">pgb</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.9060888184873294e-08
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="basis.html" class="btn btn-neutral float-left" title="4. Basis Set" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mcmurchie_davidson.html" class="btn btn-neutral float-right" title="7. Mcmurchie Davidson Scheme" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Yilin Zhao.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>